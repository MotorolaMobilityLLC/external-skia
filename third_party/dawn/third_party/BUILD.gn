dawn_thirdparty_root = "../../externals/dawn/third_party"
spirv_cross = "${dawn_thirdparty_root}/spirv-cross"

config("spirv_cross_config") {
  include_dirs = [ "$dawn_thirdparty_root" ]
  defines = [ "SPIRV_CROSS_EXCEPTIONS_TO_ASSERTIONS" ]
}

static_library("spirv_cross") {
  public_configs = [ ":spirv_cross_config" ]
  configs -= [ "//gn:warnings" ]

  cflags = []
  if (is_win) {
    cflags += [
      "/wd5850",
      "/wd4245",
      "/wd4702",
      "/wd4706",
      "/wd4715",
    ]
  }

  sources = rebase_path([
                          "GLSL.std.450.h",
                          "spirv.hpp",
                          "spirv_cfg.cpp",
                          "spirv_cfg.hpp",
                          "spirv_common.hpp",
                          "spirv_cpp.cpp",
                          "spirv_cpp.hpp",
                          "spirv_cross.cpp",
                          "spirv_cross.hpp",
                          "spirv_cross_parsed_ir.cpp",
                          "spirv_cross_parsed_ir.hpp",
                          "spirv_glsl.cpp",
                          "spirv_glsl.hpp",
                          "spirv_hlsl.cpp",
                          "spirv_hlsl.hpp",
                          "spirv_msl.cpp",
                          "spirv_msl.hpp",
                          "spirv_parser.cpp",
                          "spirv_parser.hpp",
                        ],
                        ".",
                        "${spirv_cross}")
}

# Empty targets to add the include dirs and list the sources of Khronos headers for header inclusion check.
config("khronos_headers_public") {
  include_dirs = [ "../../externals/dawn/third_party/khronos" ]
}

source_set("vulkan_headers") {
  sources = [
    "khronos/vulkan/vk_platform.h",
    "khronos/vulkan/vulkan.h",
  ]

  public_configs = [ ":khronos_headers_public" ]
}

source_set("khronos_platform") {
  sources = [
    "khronos/KHR/khrplatform.h",
  ]
  public_configs = [ ":khronos_headers_public" ]
}
